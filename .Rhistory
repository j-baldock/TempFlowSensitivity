mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date))
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
#ylim(-5,20) +
geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "red") +
facet_wrap(~year)
sub <- dat %>%
filter(site_name == "Leidy Creek Mouth NWIS") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date))
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
#ylim(-5,20) +
geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "red") +
facet_wrap(~year)
sub <- dat %>%
filter(site_name == "McGeeCreekLower") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date))
sub <- dat %>%
filter(site_name == "McGeeCreekLower") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date))
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
#ylim(-5,20) +
geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "red") +
facet_wrap(~year)
sub <- dat %>%
filter(site_name == "McGeeCreekTrib") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date))
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
#ylim(-5,20) +
geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "red") +
facet_wrap(~year)
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(20,20) +
geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "red") +
facet_wrap(~year)
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "red") +
facet_wrap(~year)
sub <- dat %>%
filter(site_name == "McGeeCreekUpper") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date))
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "red") +
facet_wrap(~year)
sub <- dat %>%
filter(site_name == "McGeeCreekTrib") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date))
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "red") +
facet_wrap(~year)
dat %>% filter(site_name == "McGeeCreekTrib") %>% #select(date, tempc_mean, air_temp_mean) %>%
ggplot() +
geom_line(aes(x = date, y = air_temp_mean), color = "darkorange") +
geom_line(aes(x = date, y = tempc_mean), color = "blue") +
theme_bw() + ylab("temperature (deg C)")
sub <- dat %>%
filter(site_name == "McGeeCreekTrib") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date))
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "red") +
facet_wrap(~year)
sub
sub
sub %>% filter(yday >= 125, yday <= 175)
sub
sub %>% filter(yday >= 125, yday <= 175)
sub %>% filter(yday >= 125, yday <= 275)
?quantile()
sub %>%
filter(yday >= 125, yday <= 275) %>%
group_by(site_name, year) %>%
summarize(index_low = quantile(index, probs = 0.001),
index_high = quantile(index, probs = 0.999))
sub %>%
filter(yday >= 125, yday <= 275) %>%
group_by(site_name, year) %>%
summarize(index_low = quantile(index, probs = 0.001, na.rm = TRUE),
index_high = quantile(index, probs = 0.999, na.rm = TRUE)) %>%
ungroup()
sub_indexci <- sub %>%
filter(yday >= 125, yday <= 275) %>%
group_by(site_name, year) %>%
summarize(index_low = quantile(index, probs = 0.001, na.rm = TRUE),
index_high = quantile(index, probs = 0.999, na.rm = TRUE)) %>%
ungroup()
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
geom_hline(data = sub_indexci, aes(y = index_low), color = "red") +
facet_wrap(~year)
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue")
geom_hline()
?geom_hline()
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
geom_hline(data = sub_indexci, aes(yintercept = index_low), color = "red") +
facet_wrap(~year)
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
geom_hline(data = sub_indexci, aes(yintercept = index_low), color = "red") +
geom_hline(data = sub_indexci, aes(yintercept = index_high), color = "red") +
facet_wrap(~year)
sub <- dat %>%
filter(site_name == "McGeeCreekTrib") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date))
sub_indexci <- sub %>%
filter(yday >= 125, yday <= 275) %>%
group_by(site_name) %>%
summarize(index_low = quantile(index, probs = 0.001, na.rm = TRUE),
index_high = quantile(index, probs = 0.999, na.rm = TRUE)) %>%
ungroup()
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
geom_hline(data = sub_indexci, aes(yintercept = index_low), color = "red") +
geom_hline(data = sub_indexci, aes(yintercept = index_high), color = "red") +
facet_wrap(~year)
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
geom_hline(data = sub_indexci, aes(yintercept = index_low), color = "red") +
geom_hline(data = sub_indexci, aes(yintercept = index_high), color = "red") +
facet_wrap(~year)
sub
sub <- dat %>%
filter(site_name == "NF Spread Creek Upper") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date)) %>%
mutatE(index_smooth10 = )
sub_indexci <- sub %>%
filter(yday >= 125, yday <= 275) %>%
group_by(site_name) %>%
summarize(index_low = quantile(index, probs = 0.001, na.rm = TRUE),
index_high = quantile(index, probs = 0.999, na.rm = TRUE)) %>%
ungroup()
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
geom_hline(yintercept = c(-1,1), color = "red")
sub <- dat %>%
filter(site_name == "NF Spread Creek Upper") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date)) %>%
mutatE(index_smooth10 = )
sub_indexci <- sub %>%
filter(yday >= 125, yday <= 275) %>%
group_by(site_name) %>%
summarize(index_low = quantile(index, probs = 0.001, na.rm = TRUE),
index_high = quantile(index, probs = 0.999, na.rm = TRUE)) %>%
ungroup()
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
geom_hline(data = sub_indexci, aes(yintercept = index_low), color = "red") +
geom_hline(data = sub_indexci, aes(yintercept = index_high), color = "red") +
facet_wrap(~year)
sub <- dat %>%
filter(site_name == "NF Spread Creek Upper") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date))
sub_indexci <- sub %>%
filter(yday >= 125, yday <= 275) %>%
group_by(site_name) %>%
summarize(index_low = quantile(index, probs = 0.001, na.rm = TRUE),
index_high = quantile(index, probs = 0.999, na.rm = TRUE)) %>%
ungroup()
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
geom_hline(data = sub_indexci, aes(yintercept = index_low), color = "red") +
geom_hline(data = sub_indexci, aes(yintercept = index_high), color = "red") +
facet_wrap(~year)
sub <- dat %>%
filter(site_name == "NF Spread Creek Upper") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date))
sub_indexci <- sub %>%
filter(yday >= 125, yday <= 275) %>%
group_by(site_name, year) %>%
summarize(index_low = quantile(index, probs = 0.001, na.rm = TRUE),
index_high = quantile(index, probs = 0.999, na.rm = TRUE)) %>%
ungroup()
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
# geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
geom_hline(data = sub_indexci, aes(yintercept = index_low), color = "red") +
geom_hline(data = sub_indexci, aes(yintercept = index_high), color = "red") +
facet_wrap(~year)
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
# geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
geom_hline(data = sub_indexci, aes(yintercept = index_low), color = "red") +
geom_hline(data = sub_indexci, aes(yintercept = index_high), color = "red") +
facet_wrap(~year)
sub <- dat %>%
filter(site_name == "NF Spread Creek Upper") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date))
sub_indexci <- sub %>%
filter(yday >= 125, yday <= 275) %>%
group_by(site_name, year) %>%
summarize(index_low = quantile(index, probs = 0.001, na.rm = TRUE),
index_high = quantile(index, probs = 0.999, na.rm = TRUE)) %>%
ungroup()
sub %>%
ggplot() +
geom_point(aes(x = date, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20)
# geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
geom_hline(data = sub_indexci, aes(yintercept = index_low), color = "red") +
geom_hline(data = sub_indexci, aes(yintercept = index_high), color = "red") +
facet_wrap(~year)
sub <- dat %>%
filter(site_name == "NF Spread Creek Upper") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date))
sub_indexci <- sub %>%
filter(yday >= 125, yday <= 275) %>%
group_by(site_name) %>%
summarize(index_low = quantile(index, probs = 0.001, na.rm = TRUE),
index_high = quantile(index, probs = 0.999, na.rm = TRUE)) %>%
ungroup()
#
# sub %>%
#   ggplot() +
#   geom_point(aes(x = date, y = index)) +
#   theme_bw() + ylab("temperature index") +
#   ylim(-20,20)
#   # geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
geom_hline(data = sub_indexci, aes(yintercept = index_low), color = "red") +
geom_hline(data = sub_indexci, aes(yintercept = index_high), color = "red") +
facet_wrap(~year)
sub_indexci
sub
t.test(sub$index)
t.test(sub$index)$conf.int
t.test(sub$index, conf.level = 0.999)$conf.int
t.test(sub$index, conf.level = 0.999)$conf.int[1]
t.test(sub$index, conf.level = 0.999)$conf.int[2]
t.test(sub$index, conf.level = 0.999)$conf.int
sub %>%
filter(yday >= 125, yday <= 275) %>%
group_by(site_name) %>%
summarize(index_low = t.test(index, conf.level = 0.999)$conf.int[1],
index_high = t.test(index, conf.level = 0.999)$conf.int[2]) %>%
ungroup()
sub %>%
filter(yday >= 125, yday <= 275) %>%
group_by(site_name, year) %>%
summarize(index_low = t.test(index, conf.level = 0.999)$conf.int[1],
index_high = t.test(index, conf.level = 0.999)$conf.int[2]) %>%
ungroup()
sub <- dat %>%
filter(site_name == "NF Spread Creek Upper") %>%
mutate(index = ifelse(tempc_mean > 0, (tempc_mean - air_temp_mean) / tempc_mean, NA),
year = year(date))
# sub_indexci <- sub %>%
#   filter(yday >= 125, yday <= 275) %>%
#   group_by(site_name) %>%
#   summarize(index_low = quantile(index, probs = 0.001, na.rm = TRUE),
#             index_high = quantile(index, probs = 0.999, na.rm = TRUE)) %>%
#   ungroup()
sub_indexci <- sub %>%
filter(yday >= 125, yday <= 275) %>%
group_by(site_name, year) %>%
summarize(index_low = t.test(index, conf.level = 0.999)$conf.int[1],
index_high = t.test(index, conf.level = 0.999)$conf.int[2]) %>%
ungroup()
#
# sub %>%
#   ggplot() +
#   geom_point(aes(x = date, y = index)) +
#   theme_bw() + ylab("temperature index") +
#   ylim(-20,20)
#   # geom_hline(yintercept = c(-1,1), color = "red")
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-20,20) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
geom_hline(data = sub_indexci, aes(yintercept = index_low), color = "red") +
geom_hline(data = sub_indexci, aes(yintercept = index_high), color = "red") +
facet_wrap(~year)
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-5,5) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
geom_hline(data = sub_indexci, aes(yintercept = index_low), color = "red") +
geom_hline(data = sub_indexci, aes(yintercept = index_high), color = "red") +
facet_wrap(~year)
sub %>%
ggplot() +
geom_point(aes(x = yday, y = index)) +
theme_bw() + ylab("temperature index") +
ylim(-2,2) +
# geom_hline(yintercept = c(-1,1), color = "red") +
geom_vline(xintercept = c(125,275), color = "blue") +
geom_hline(data = sub_indexci, aes(yintercept = index_low), color = "red") +
geom_hline(data = sub_indexci, aes(yintercept = index_high), color = "red") +
facet_wrap(~year)
quarto::quarto_render(output_format = "html")
quarto::quarto_render(output_format = "html")
